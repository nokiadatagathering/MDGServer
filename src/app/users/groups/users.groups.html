<div class="b-page__line">

  <div class="b-content-header">

    <h1 class="b-content-header__title" role="heading">
      {{'header.users' | translate}}
    </h1>

    <p class="b-content-header__text">
      {{'users.SUBTITLE' | translate}}
    </p>

  </div>
</div>

<div class="b-page__line">
  <div class="b-content">
    <div class="b-content__users">
      <div class="b-content__users__groups-box">
        <button class="e-create-btn b-content__users--bnt-top"
                role="button"
                ng-click="groupName = ''; showNewGroup = true; groupNameFocus = true">
          <span class="fa fa-plus e-create-btn--icon"></span>
          <span class="e-create-btn--title">{{ 'users.Add_Group' | translate }}</span>
        </button>

        <table class="b-table__box b-content__users__groups-box__group-table">
          <tbody class="b-table__body" >
          <div ng-if="showNewGroup"
               class="b-content__users__groups-box__group-table__new-group new-group">
            <form id="newGroup"
                  name="newGroup">
                      <span focus-me="groupName">
                          <input type="text"
                                 form="newGroup"
                                 id="groupName"
                                 class="groupName b-content__users__groups-box__group-table__new-group--input"
                                 placeholder="{{ 'users.New_group_name' | translate }}"
                                 name="groupName"
                                 ng-minlength="2"
                                 ng-maxlength="60"
                                 ng-trim="true"
                                 ng-change="errorExistingGroupName = false"
                                 ng-model="groupName">

                        <button type="submit" form="newGroup"
                                ng-click="saveNewGroup(groupName)"
                                role="button"
                                class="b-content__users__groups-box__group-table__new-group--button transparent-button">
                          <span class="fa fa-check-circle"></span>
                          <span class="button-title">{{ 'users.save_group' | translate }}</span>
                        </button>
                          <div errorsblock="errors.groupName"></div>
                      </span>
            </form>
          </div>
          <tr class="b-table__body__row"
              ng-class="{ 'b-table__body__row--active': $state.includes('page.users') && $stateParams.groupId == '' }">
            <td class="b-table__body__row__col">
              <span class="b-table__body__row__circle">{{allUsers.length}}</span>
              <a class="b-table__body__row__col--text"
                 ui-sref="page.users.group({groupId: ''})"
                 href="/#/users/group:">{{ 'users.All_users' | translate }}</a>
            </td>
          </tr>

          <tr class="b-table__body__row droppable"
              role="row"
              id={{group._id}}
              ng-class="{ 'b-table__body__row--active': $state.includes('page.users') && $stateParams.groupId == group._id }"
              ng-repeat="group in filtered = (groups | deletedItemsFilter : 'groups')"
              style=" display: {{group.hidden ? 'none' : 'table-row'}};">
            <td class="b-table__body__row__col">
              <span class="b-table__body__row__circle">{{group.users.length}}</span>
              <a class="b-table__body__row__col--text"
                 ui-sref="page.users.group({groupId: group._id})"
                 href="/#/users/group:{{group._id}}">{{group.name}}</a>

              <div class="b-content__users__groups-box__group-table__group__rules">
                <button class="transparent-button"  role="button"
                        title="{{ 'users.Send_SMS_group' | translate }}"
                        ui-sref="page.users.group.smstogroup({groupId: group._id})">
                  <a class="fa fa-envelope"></a>
                  <span class="button-title">{{ 'users.Send_SMS_group' | translate }}</span>
                </button>
                <button class="transparent-button"
                        role="button"
                        title="{{ 'users.Delete_group' | translate }}"
                        ng-click="deleteGroup(group._id, group.name)">
                  <span class="fa fa-trash-o"></span>
                  <span class="button-title">{{ 'users.Delete_group' | translate }}</span>
                </button>

              </div>

            </td>
          </tr>

          </tbody>
        </table>

      </div>
      <div ui-view class=""></div>
    </div>
  </div>
</div>


